\chapter{The Optimal \XX \ Predictor}\label{app:opred}
Given $I(\mathbf{x})$ a candidate index function we associate the point-like measure
\[
p_i(\mathbf{x}) = \delta_{i,I(\mathbf{x})}.
\]
Written in terms of $p$ the loss function reads
\[
{\cal L}_2(\hat y,p) = {\mathbb E}_{x,{\bf y}}\Bigl[\sum_{i\in T} p_i(\mathbf{x})\bigl(y_i-\hat y(\mathbf{x})\bigr)^2\Bigr].
\]
%Under~(\ref{eq:py}) (with $\alpha_{ij}=\alpha\delta_{ij}$) the loss is equal to
Under~\cref{eq:py} (with $\alpha_{ij}=\alpha\delta_{ij}$) the loss is equal to
\[
{\cal L}_2(\hat y,p) = {\mathbb E}_x\Bigl[\sum_{i\in T} p_i(\mathbf{x})\Bigl( \bigl(\hat y_i(\mathbf{x})-\hat y(\mathbf{x})\bigr)^2-\hat p_i(\mathbf{x})\frac{\alpha\sigma^2}{1+\alpha}\Bigr)\Bigr]+\sigma^2
\]
The minimization w.r.t. $\hat y$ yields
\begin{equation}\label{eq:hy}
\hat y(\mathbf{x}) = \sum_{i\in T} p_i(\mathbf{x})\hat y_i(\mathbf{x}).
\end{equation}
In turn, as a function of $p_i$ the loss being a  convex combination, its minimization yields
\begin{align}
  p_i(\mathbf{x}) &= \delta_{i,I(\mathbf{x})},\label{eq:hp}\\[0.2cm]
  I(\mathbf{x}) &= \argmin_{i\in T}\Bigl(\bigl(\hat y_i(\mathbf{x})-\hat y(\mathbf{x})\bigr)^2-\hat p_i(\mathbf{x})\frac{\alpha\sigma^2}{1+\alpha}\Bigr).\label{eq:hI}
\end{align}
Combining these equations~(\ref{eq:hy},\ref{eq:hp},\ref{eq:hI}) we get
\[
I(\mathbf{x}) = \argmax_{i\in T}\bigl(\hat p_i(\mathbf{x})\bigr),
\]
which concludes the proof.  
